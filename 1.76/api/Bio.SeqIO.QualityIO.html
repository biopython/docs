

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Bio.SeqIO.QualityIO module &mdash; Biopython 1.76 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/biopython.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Bio.SeqIO.SeqXmlIO module" href="Bio.SeqIO.SeqXmlIO.html" />
    <link rel="prev" title="Bio.SeqIO.PirIO module" href="Bio.SeqIO.PirIO.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #10100F" >
          

          
            <a href="index.html">
          

          
            
            <img src="_static/biopython_logo_white.png" class="logo" alt="Logo"/>
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">API Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="Bio.html">Bio package</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="Bio.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="Bio.Affy.html">Bio.Affy package</a></li>
<li class="toctree-l3"><a class="reference internal" href="Bio.Align.html">Bio.Align package</a></li>
<li class="toctree-l3"><a class="reference internal" href="Bio.AlignIO.html">Bio.AlignIO package</a></li>
<li class="toctree-l3"><a class="reference internal" href="Bio.Alphabet.html">Bio.Alphabet package</a></li>
<li class="toctree-l3"><a class="reference internal" href="Bio.Application.html">Bio.Application package</a></li>
<li class="toctree-l3"><a class="reference internal" href="Bio.Blast.html">Bio.Blast package</a></li>
<li class="toctree-l3"><a class="reference internal" href="Bio.CAPS.html">Bio.CAPS package</a></li>
<li class="toctree-l3"><a class="reference internal" href="Bio.Cluster.html">Bio.Cluster package</a></li>
<li class="toctree-l3"><a class="reference internal" href="Bio.Compass.html">Bio.Compass package</a></li>
<li class="toctree-l3"><a class="reference internal" href="Bio.Crystal.html">Bio.Crystal package</a></li>
<li class="toctree-l3"><a class="reference internal" href="Bio.Data.html">Bio.Data package</a></li>
<li class="toctree-l3"><a class="reference internal" href="Bio.Emboss.html">Bio.Emboss package</a></li>
<li class="toctree-l3"><a class="reference internal" href="Bio.Entrez.html">Bio.Entrez package</a></li>
<li class="toctree-l3"><a class="reference internal" href="Bio.ExPASy.html">Bio.ExPASy package</a></li>
<li class="toctree-l3"><a class="reference internal" href="Bio.FSSP.html">Bio.FSSP package</a></li>
<li class="toctree-l3"><a class="reference internal" href="Bio.GenBank.html">Bio.GenBank package</a></li>
<li class="toctree-l3"><a class="reference internal" href="Bio.Geo.html">Bio.Geo package</a></li>
<li class="toctree-l3"><a class="reference internal" href="Bio.Graphics.html">Bio.Graphics package</a></li>
<li class="toctree-l3"><a class="reference internal" href="Bio.HMM.html">Bio.HMM package</a></li>
<li class="toctree-l3"><a class="reference internal" href="Bio.KDTree.html">Bio.KDTree package</a></li>
<li class="toctree-l3"><a class="reference internal" href="Bio.KEGG.html">Bio.KEGG package</a></li>
<li class="toctree-l3"><a class="reference internal" href="Bio.Medline.html">Bio.Medline package</a></li>
<li class="toctree-l3"><a class="reference internal" href="Bio.NMR.html">Bio.NMR package</a></li>
<li class="toctree-l3"><a class="reference internal" href="Bio.Nexus.html">Bio.Nexus package</a></li>
<li class="toctree-l3"><a class="reference internal" href="Bio.PDB.html">Bio.PDB package</a></li>
<li class="toctree-l3"><a class="reference internal" href="Bio.Pathway.html">Bio.Pathway package</a></li>
<li class="toctree-l3"><a class="reference internal" href="Bio.Phylo.html">Bio.Phylo package</a></li>
<li class="toctree-l3"><a class="reference internal" href="Bio.PopGen.html">Bio.PopGen package</a></li>
<li class="toctree-l3"><a class="reference internal" href="Bio.Restriction.html">Bio.Restriction package</a></li>
<li class="toctree-l3"><a class="reference internal" href="Bio.SCOP.html">Bio.SCOP package</a></li>
<li class="toctree-l3"><a class="reference internal" href="Bio.SVDSuperimposer.html">Bio.SVDSuperimposer package</a></li>
<li class="toctree-l3"><a class="reference internal" href="Bio.SearchIO.html">Bio.SearchIO package</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="Bio.SeqIO.html">Bio.SeqIO package</a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="Bio.SeqIO.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="Bio.SeqIO.html#module-Bio.SeqIO">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Bio.SeqUtils.html">Bio.SeqUtils package</a></li>
<li class="toctree-l3"><a class="reference internal" href="Bio.Sequencing.html">Bio.Sequencing package</a></li>
<li class="toctree-l3"><a class="reference internal" href="Bio.Statistics.html">Bio.Statistics package</a></li>
<li class="toctree-l3"><a class="reference internal" href="Bio.SubsMat.html">Bio.SubsMat package</a></li>
<li class="toctree-l3"><a class="reference internal" href="Bio.SwissProt.html">Bio.SwissProt package</a></li>
<li class="toctree-l3"><a class="reference internal" href="Bio.TogoWS.html">Bio.TogoWS package</a></li>
<li class="toctree-l3"><a class="reference internal" href="Bio.UniGene.html">Bio.UniGene package</a></li>
<li class="toctree-l3"><a class="reference internal" href="Bio.UniProt.html">Bio.UniProt package</a></li>
<li class="toctree-l3"><a class="reference internal" href="Bio.Wise.html">Bio.Wise package</a></li>
<li class="toctree-l3"><a class="reference internal" href="Bio.codonalign.html">Bio.codonalign package</a></li>
<li class="toctree-l3"><a class="reference internal" href="Bio.motifs.html">Bio.motifs package</a></li>
<li class="toctree-l3"><a class="reference internal" href="Bio.phenotype.html">Bio.phenotype package</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Bio.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="Bio.html#module-Bio">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="BioSQL.html">BioSQL package</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Biopython</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="Bio.html">Bio package</a> &raquo;</li>
        
          <li><a href="Bio.SeqIO.html">Bio.SeqIO package</a> &raquo;</li>
        
      <li>Bio.SeqIO.QualityIO module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <!-- User defined GitHub URL -->
              <a href="https://github.com/biopython/biopython/blob/master/Bio/SeqIO/QualityIO.py" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <div class="rst-breadcrumbs-buttons" role="navigation" aria-label="breadcrumb navigation">
      
        <a href="Bio.SeqIO.SeqXmlIO.html" class="btn btn-neutral float-right" title="Bio.SeqIO.SeqXmlIO module" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Bio.SeqIO.PirIO.html" class="btn btn-neutral float-left" title="Bio.SeqIO.PirIO module" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
  </div>
  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-Bio.SeqIO.QualityIO">
<span id="bio-seqio-qualityio-module"></span><h1>Bio.SeqIO.QualityIO module<a class="headerlink" href="#module-Bio.SeqIO.QualityIO" title="Permalink to this headline">¶</a></h1>
<p>Bio.SeqIO support for the FASTQ and QUAL file formats.</p>
<p>Note that you are expected to use this code via the Bio.SeqIO interface, as
shown below.</p>
<p>The FASTQ file format is used frequently at the Wellcome Trust Sanger Institute
to bundle a FASTA sequence and its PHRED quality data (integers between 0 and
90).  Rather than using a single FASTQ file, often paired FASTA and QUAL files
are used containing the sequence and the quality information separately.</p>
<p>The PHRED software reads DNA sequencing trace files, calls bases, and
assigns a non-negative quality value to each called base using a logged
transformation of the error probability, Q = -10 log10( Pe ), for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Pe</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>         <span class="n">Q</span> <span class="o">=</span>  <span class="mi">0</span>
<span class="n">Pe</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>         <span class="n">Q</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">Pe</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span>        <span class="n">Q</span> <span class="o">=</span> <span class="mi">20</span>
<span class="o">...</span>
<span class="n">Pe</span> <span class="o">=</span> <span class="mf">0.00000001</span><span class="p">,</span>  <span class="n">Q</span> <span class="o">=</span> <span class="mi">80</span>
<span class="n">Pe</span> <span class="o">=</span> <span class="mf">0.000000001</span><span class="p">,</span> <span class="n">Q</span> <span class="o">=</span> <span class="mi">90</span>
</pre></div>
</div>
<p>In typical raw sequence reads, the PHRED quality valuea will be from 0 to 40.
In the QUAL format these quality values are held as space separated text in
a FASTA like file format.  In the FASTQ format, each quality values is encoded
with a single ASCI character using chr(Q+33), meaning zero maps to the
character “!” and for example 80 maps to “q”.  For the Sanger FASTQ standard
the allowed range of PHRED scores is 0 to 93 inclusive. The sequences and
quality are then stored in pairs in a FASTA like format.</p>
<p>Unfortunately there is no official document describing the FASTQ file format,
and worse, several related but different variants exist. For more details,
please read this open access publication:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">The</span> <span class="n">Sanger</span> <span class="n">FASTQ</span> <span class="n">file</span> <span class="nb">format</span> <span class="k">for</span> <span class="n">sequences</span> <span class="k">with</span> <span class="n">quality</span> <span class="n">scores</span><span class="p">,</span> <span class="ow">and</span> <span class="n">the</span>
<span class="n">Solexa</span><span class="o">/</span><span class="n">Illumina</span> <span class="n">FASTQ</span> <span class="n">variants</span><span class="o">.</span>
<span class="n">P</span><span class="o">.</span><span class="n">J</span><span class="o">.</span><span class="n">A</span><span class="o">.</span><span class="n">Cock</span> <span class="p">(</span><span class="n">Biopython</span><span class="p">),</span> <span class="n">C</span><span class="o">.</span><span class="n">J</span><span class="o">.</span><span class="n">Fields</span> <span class="p">(</span><span class="n">BioPerl</span><span class="p">),</span> <span class="n">N</span><span class="o">.</span><span class="n">Goto</span> <span class="p">(</span><span class="n">BioRuby</span><span class="p">),</span>
<span class="n">M</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">Heuer</span> <span class="p">(</span><span class="n">BioJava</span><span class="p">)</span> <span class="ow">and</span> <span class="n">P</span><span class="o">.</span><span class="n">M</span><span class="o">.</span> <span class="n">Rice</span> <span class="p">(</span><span class="n">EMBOSS</span><span class="p">)</span><span class="o">.</span>
<span class="n">Nucleic</span> <span class="n">Acids</span> <span class="n">Research</span> <span class="mi">2010</span> <span class="mi">38</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span><span class="mi">1767</span><span class="o">-</span><span class="mi">1771</span>
<span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">doi</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="mf">10.1093</span><span class="o">/</span><span class="n">nar</span><span class="o">/</span><span class="n">gkp1137</span>
</pre></div>
</div>
<p>The good news is that Roche 454 sequencers can output files in the QUAL format,
and sensibly they use PHREP style scores like Sanger.  Converting a pair of
FASTA and QUAL files into a Sanger style FASTQ file is easy. To extract QUAL
files from a Roche 454 SFF binary file, use the Roche off instrument command
line tool “sffinfo” with the -q or -qual argument.  You can extract a matching
FASTA file using the -s or -seq argument instead.</p>
<p>The bad news is that Solexa/Illumina did things differently - they have their
own scoring system AND their own incompatible versions of the FASTQ format.
Solexa/Illumina quality scores use Q = - 10 log10 ( Pe / (1-Pe) ), which can
be negative.  PHRED scores and Solexa scores are NOT interchangeable (but a
reasonable mapping can be achieved between them, and they are approximately
equal for higher quality reads).</p>
<p>Confusingly early Solexa pipelines produced a FASTQ like file but using their
own score mapping and an ASCII offset of 64. To make things worse, for the
Solexa/Illumina pipeline 1.3 onwards, they introduced a third variant of the
FASTQ file format, this time using PHRED scores (which is more consistent) but
with an ASCII offset of 64.</p>
<p>i.e. There are at least THREE different and INCOMPATIBLE variants of the FASTQ
file format: The original Sanger PHRED standard, and two from Solexa/Illumina.</p>
<p>The good news is that as of CASAVA version 1.8, Illumina sequencers will
produce FASTQ files using the standard Sanger encoding.</p>
<p>You are expected to use this module via the Bio.SeqIO functions, with the
following format names:</p>
<blockquote>
<div><ul class="simple">
<li><p>“qual” means simple quality files using PHRED scores (e.g. from Roche 454)</p></li>
<li><p>“fastq” means Sanger style FASTQ files using PHRED scores and an ASCII
offset of 33 (e.g. from the NCBI Short Read Archive and Illumina 1.8+).
These can potentially hold PHRED scores from 0 to 93.</p></li>
<li><p>“fastq-sanger” is an alias for “fastq”.</p></li>
<li><p>“fastq-solexa” means old Solexa (and also very early Illumina) style FASTQ
files, using Solexa scores with an ASCII offset 64. These can hold Solexa
scores from -5 to 62.</p></li>
<li><p>“fastq-illumina” means newer Illumina 1.3 to 1.7 style FASTQ files, using
PHRED scores but with an ASCII offset 64, allowing PHRED scores from 0
to 62.</p></li>
</ul>
</div></blockquote>
<p>We could potentially add support for “qual-solexa” meaning QUAL files which
contain Solexa scores, but thus far there isn’t any reason to use such files.</p>
<p>For example, consider the following short FASTQ file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@EAS54_6_R1_2_1_413_324</span>
<span class="n">CCCTTCTTGTCTTCAGCGTTTCTCC</span>
<span class="o">+</span>
<span class="p">;;</span><span class="mi">3</span><span class="p">;;;;;;;;;;;;</span><span class="mi">7</span><span class="p">;;;;;;;</span><span class="mi">88</span>
<span class="nd">@EAS54_6_R1_2_1_540_792</span>
<span class="n">TTGGCAGGCCAAGGCCGATGGATCA</span>
<span class="o">+</span>
<span class="p">;;;;;;;;;;;</span><span class="mi">7</span><span class="p">;;;;;</span><span class="o">-</span><span class="p">;;;</span><span class="mi">3</span><span class="p">;</span><span class="mi">83</span>
<span class="nd">@EAS54_6_R1_2_1_443_348</span>
<span class="n">GTTGCTTCTGGCGTGGGTGGGGGGG</span>
<span class="o">+</span>
<span class="p">;;;;;;;;;;;</span><span class="mi">9</span><span class="p">;</span><span class="mi">7</span><span class="p">;;</span><span class="o">.</span><span class="mi">7</span><span class="p">;</span><span class="mi">393333</span>
</pre></div>
</div>
<p>This contains three reads of length 25.  From the read length these were
probably originally from an early Solexa/Illumina sequencer but this file
follows the Sanger FASTQ convention (PHRED style qualities with an ASCII
offet of 33).  This means we can parse this file using Bio.SeqIO using
“fastq” as the format name:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Bio</span> <span class="kn">import</span> <span class="n">SeqIO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">SeqIO</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s2">&quot;Quality/example.fastq&quot;</span><span class="p">,</span> <span class="s2">&quot;fastq&quot;</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">record</span><span class="o">.</span><span class="n">seq</span><span class="p">))</span>
<span class="go">EAS54_6_R1_2_1_413_324 CCCTTCTTGTCTTCAGCGTTTCTCC</span>
<span class="go">EAS54_6_R1_2_1_540_792 TTGGCAGGCCAAGGCCGATGGATCA</span>
<span class="go">EAS54_6_R1_2_1_443_348 GTTGCTTCTGGCGTGGGTGGGGGGG</span>
</pre></div>
</div>
<p>The qualities are held as a list of integers in each record’s annotation:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>
<span class="go">ID: EAS54_6_R1_2_1_443_348</span>
<span class="go">Name: EAS54_6_R1_2_1_443_348</span>
<span class="go">Description: EAS54_6_R1_2_1_443_348</span>
<span class="go">Number of features: 0</span>
<span class="go">Per letter annotation for: phred_quality</span>
<span class="go">Seq(&#39;GTTGCTTCTGGCGTGGGTGGGGGGG&#39;, SingleLetterAlphabet())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">letter_annotations</span><span class="p">[</span><span class="s2">&quot;phred_quality&quot;</span><span class="p">])</span>
<span class="go">[26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 24, 26, 22, 26, 26, 13, 22, 26, 18, 24, 18, 18, 18, 18]</span>
</pre></div>
</div>
<p>You can use the SeqRecord format method to show this in the QUAL format:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;qual&quot;</span><span class="p">))</span>
<span class="go">&gt;EAS54_6_R1_2_1_443_348</span>
<span class="go">26 26 26 26 26 26 26 26 26 26 26 24 26 22 26 26 13 22 26 18</span>
<span class="go">24 18 18 18 18</span>
</pre></div>
</div>
<p>Or go back to the FASTQ format, use “fastq” (or “fastq-sanger”):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;fastq&quot;</span><span class="p">))</span>
<span class="go">@EAS54_6_R1_2_1_443_348</span>
<span class="go">GTTGCTTCTGGCGTGGGTGGGGGGG</span>
<span class="go">+</span>
<span class="go">;;;;;;;;;;;9;7;;.7;393333</span>
</pre></div>
</div>
<p>Or, using the Illumina 1.3+ FASTQ encoding (PHRED values with an ASCII offset
of 64):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;fastq-illumina&quot;</span><span class="p">))</span>
<span class="go">@EAS54_6_R1_2_1_443_348</span>
<span class="go">GTTGCTTCTGGCGTGGGTGGGGGGG</span>
<span class="go">+</span>
<span class="go">ZZZZZZZZZZZXZVZZMVZRXRRRR</span>
</pre></div>
</div>
<p>You can also get Biopython to convert the scores and show a Solexa style
FASTQ file:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;fastq-solexa&quot;</span><span class="p">))</span>
<span class="go">@EAS54_6_R1_2_1_443_348</span>
<span class="go">GTTGCTTCTGGCGTGGGTGGGGGGG</span>
<span class="go">+</span>
<span class="go">ZZZZZZZZZZZXZVZZMVZRXRRRR</span>
</pre></div>
</div>
<p>Notice that this is actually the same output as above using “fastq-illumina”
as the format! The reason for this is all these scores are high enough that
the PHRED and Solexa scores are almost equal. The differences become apparent
for poor quality reads. See the functions solexa_quality_from_phred and
phred_quality_from_solexa for more details.</p>
<p>If you wanted to trim your sequences (perhaps to remove low quality regions,
or to remove a primer sequence), try slicing the SeqRecord objects.  e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sub_rec</span> <span class="o">=</span> <span class="n">record</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">15</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">sub_rec</span><span class="p">)</span>
<span class="go">ID: EAS54_6_R1_2_1_443_348</span>
<span class="go">Name: EAS54_6_R1_2_1_443_348</span>
<span class="go">Description: EAS54_6_R1_2_1_443_348</span>
<span class="go">Number of features: 0</span>
<span class="go">Per letter annotation for: phred_quality</span>
<span class="go">Seq(&#39;TTCTGGCGTG&#39;, SingleLetterAlphabet())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">sub_rec</span><span class="o">.</span><span class="n">letter_annotations</span><span class="p">[</span><span class="s2">&quot;phred_quality&quot;</span><span class="p">])</span>
<span class="go">[26, 26, 26, 26, 26, 26, 24, 26, 22, 26]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">sub_rec</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;fastq&quot;</span><span class="p">))</span>
<span class="go">@EAS54_6_R1_2_1_443_348</span>
<span class="go">TTCTGGCGTG</span>
<span class="go">+</span>
<span class="go">;;;;;;9;7;</span>
</pre></div>
</div>
<p>If you wanted to, you could read in this FASTQ file, and save it as a QUAL file:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Bio</span> <span class="kn">import</span> <span class="n">SeqIO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">record_iterator</span> <span class="o">=</span> <span class="n">SeqIO</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s2">&quot;Quality/example.fastq&quot;</span><span class="p">,</span> <span class="s2">&quot;fastq&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;Quality/temp.qual&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">out_handle</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">SeqIO</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">record_iterator</span><span class="p">,</span> <span class="n">out_handle</span><span class="p">,</span> <span class="s2">&quot;qual&quot;</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
<p>You can of course read in a QUAL file, such as the one we just created:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Bio</span> <span class="kn">import</span> <span class="n">SeqIO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">SeqIO</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s2">&quot;Quality/temp.qual&quot;</span><span class="p">,</span> <span class="s2">&quot;qual&quot;</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">record</span><span class="o">.</span><span class="n">seq</span><span class="p">))</span>
<span class="go">EAS54_6_R1_2_1_413_324 ?????????????????????????</span>
<span class="go">EAS54_6_R1_2_1_540_792 ?????????????????????????</span>
<span class="go">EAS54_6_R1_2_1_443_348 ?????????????????????????</span>
</pre></div>
</div>
<p>Notice that QUAL files don’t have a proper sequence present!  But the quality
information is there:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>
<span class="go">ID: EAS54_6_R1_2_1_443_348</span>
<span class="go">Name: EAS54_6_R1_2_1_443_348</span>
<span class="go">Description: EAS54_6_R1_2_1_443_348</span>
<span class="go">Number of features: 0</span>
<span class="go">Per letter annotation for: phred_quality</span>
<span class="go">UnknownSeq(25, alphabet=SingleLetterAlphabet(), character=&#39;?&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">letter_annotations</span><span class="p">[</span><span class="s2">&quot;phred_quality&quot;</span><span class="p">])</span>
<span class="go">[26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 24, 26, 22, 26, 26, 13, 22, 26, 18, 24, 18, 18, 18, 18]</span>
</pre></div>
</div>
<p>Just to keep things tidy, if you are following this example yourself, you can
delete this temporary file now:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s2">&quot;Quality/temp.qual&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Sometimes you won’t have a FASTQ file, but rather just a pair of FASTA and QUAL
files.  Because the Bio.SeqIO system is designed for reading single files, you
would have to read the two in separately and then combine the data.  However,
since this is such a common thing to want to do, there is a helper iterator
defined in this module that does this for you - PairedFastaQualIterator.</p>
<p>Alternatively, if you have enough RAM to hold all the records in memory at once,
then a simple dictionary approach would work:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Bio</span> <span class="kn">import</span> <span class="n">SeqIO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reads</span> <span class="o">=</span> <span class="n">SeqIO</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="n">SeqIO</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s2">&quot;Quality/example.fasta&quot;</span><span class="p">,</span> <span class="s2">&quot;fasta&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">SeqIO</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s2">&quot;Quality/example.qual&quot;</span><span class="p">,</span> <span class="s2">&quot;qual&quot;</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">reads</span><span class="p">[</span><span class="n">rec</span><span class="o">.</span><span class="n">id</span><span class="p">]</span><span class="o">.</span><span class="n">letter_annotations</span><span class="p">[</span><span class="s2">&quot;phred_quality&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">rec</span><span class="o">.</span><span class="n">letter_annotations</span><span class="p">[</span><span class="s2">&quot;phred_quality&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>You can then access any record by its key, and get both the sequence and the
quality scores.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">reads</span><span class="p">[</span><span class="s2">&quot;EAS54_6_R1_2_1_540_792&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;fastq&quot;</span><span class="p">))</span>
<span class="go">@EAS54_6_R1_2_1_540_792</span>
<span class="go">TTGGCAGGCCAAGGCCGATGGATCA</span>
<span class="go">+</span>
<span class="go">;;;;;;;;;;;7;;;;;-;;;3;83</span>
</pre></div>
</div>
<p>It is important that you explicitly tell Bio.SeqIO which FASTQ variant you are
using (“fastq” or “fastq-sanger” for the Sanger standard using PHRED values,
“fastq-solexa” for the original Solexa/Illumina variant, or “fastq-illumina”
for the more recent variant), as this cannot be detected reliably
automatically.</p>
<p>To illustrate this problem, let’s consider an artificial example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Bio.Seq</span> <span class="kn">import</span> <span class="n">Seq</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Bio.Alphabet</span> <span class="kn">import</span> <span class="n">generic_dna</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Bio.SeqRecord</span> <span class="kn">import</span> <span class="n">SeqRecord</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test</span> <span class="o">=</span> <span class="n">SeqRecord</span><span class="p">(</span><span class="n">Seq</span><span class="p">(</span><span class="s2">&quot;NACGTACGTA&quot;</span><span class="p">,</span> <span class="n">generic_dna</span><span class="p">),</span> <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;Test&quot;</span><span class="p">,</span>
<span class="gp">... </span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;Made up!&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">test</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;fasta&quot;</span><span class="p">))</span>
<span class="go">&gt;Test Made up!</span>
<span class="go">NACGTACGTA</span>

<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">test</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;fastq&quot;</span><span class="p">))</span>
<span class="gt">Traceback (most recent call last):</span>
 <span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">No suitable quality scores found in letter_annotations of SeqRecord (id=Test).</span>
</pre></div>
</div>
<p>We created a sample SeqRecord, and can show it in FASTA format - but for QUAL
or FASTQ format we need to provide some quality scores. These are held as a
list of integers (one for each base) in the letter_annotations dictionary:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">test</span><span class="o">.</span><span class="n">letter_annotations</span><span class="p">[</span><span class="s2">&quot;phred_quality&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">test</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;qual&quot;</span><span class="p">))</span>
<span class="go">&gt;Test Made up!</span>
<span class="go">0 1 2 3 4 5 10 20 30 40</span>

<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">test</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;fastq&quot;</span><span class="p">))</span>
<span class="go">@Test Made up!</span>
<span class="go">NACGTACGTA</span>
<span class="go">+</span>
<span class="go">!&quot;#$%&amp;+5?I</span>
</pre></div>
</div>
<p>We can check this FASTQ encoding - the first PHRED quality was zero, and this
mapped to a exclamation mark, while the final score was 40 and this mapped to
the letter “I”:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;!&#39;</span><span class="p">)</span> <span class="o">-</span> <span class="mi">33</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;I&#39;</span><span class="p">)</span> <span class="o">-</span> <span class="mi">33</span>
<span class="go">40</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="nb">ord</span><span class="p">(</span><span class="n">letter</span><span class="p">)</span><span class="o">-</span><span class="mi">33</span> <span class="k">for</span> <span class="n">letter</span> <span class="ow">in</span> <span class="s1">&#39;!&quot;#$%&amp;+5?I&#39;</span><span class="p">]</span>
<span class="go">[0, 1, 2, 3, 4, 5, 10, 20, 30, 40]</span>
</pre></div>
</div>
<p>Similarly, we could produce an Illumina 1.3 to 1.7 style FASTQ file using PHRED
scores with an offset of 64:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">test</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;fastq-illumina&quot;</span><span class="p">))</span>
<span class="go">@Test Made up!</span>
<span class="go">NACGTACGTA</span>
<span class="go">+</span>
<span class="go">@ABCDEJT^h</span>
</pre></div>
</div>
<p>And we can check this too - the first PHRED score was zero, and this mapped to
“&#64;”, while the final score was 40 and this mapped to “h”:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">ord</span><span class="p">(</span><span class="s2">&quot;@&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="mi">64</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">ord</span><span class="p">(</span><span class="s2">&quot;h&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="mi">64</span>
<span class="go">40</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="nb">ord</span><span class="p">(</span><span class="n">letter</span><span class="p">)</span><span class="o">-</span><span class="mi">64</span> <span class="k">for</span> <span class="n">letter</span> <span class="ow">in</span> <span class="s2">&quot;@ABCDEJT^h&quot;</span><span class="p">]</span>
<span class="go">[0, 1, 2, 3, 4, 5, 10, 20, 30, 40]</span>
</pre></div>
</div>
<p>Notice how different the standard Sanger FASTQ and the Illumina 1.3 to 1.7 style
FASTQ files look for the same data! Then we have the older Solexa/Illumina
format to consider which encodes Solexa scores instead of PHRED scores.</p>
<p>First let’s see what Biopython says if we convert the PHRED scores into Solexa
scores (rounding to one decimal place):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">]:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;PHRED </span><span class="si">%i</span><span class="s2"> maps to Solexa </span><span class="si">%0.1f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">solexa_quality_from_phred</span><span class="p">(</span><span class="n">q</span><span class="p">)))</span>
<span class="go">PHRED 0 maps to Solexa -5.0</span>
<span class="go">PHRED 1 maps to Solexa -5.0</span>
<span class="go">PHRED 2 maps to Solexa -2.3</span>
<span class="go">PHRED 3 maps to Solexa -0.0</span>
<span class="go">PHRED 4 maps to Solexa 1.8</span>
<span class="go">PHRED 5 maps to Solexa 3.3</span>
<span class="go">PHRED 10 maps to Solexa 9.5</span>
<span class="go">PHRED 20 maps to Solexa 20.0</span>
<span class="go">PHRED 30 maps to Solexa 30.0</span>
<span class="go">PHRED 40 maps to Solexa 40.0</span>
</pre></div>
</div>
<p>Now here is the record using the old Solexa style FASTQ file:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">test</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;fastq-solexa&quot;</span><span class="p">))</span>
<span class="go">@Test Made up!</span>
<span class="go">NACGTACGTA</span>
<span class="go">+</span>
<span class="go">;;&gt;@BCJT^h</span>
</pre></div>
</div>
<p>Again, this is using an ASCII offset of 64, so we can check the Solexa scores:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="nb">ord</span><span class="p">(</span><span class="n">letter</span><span class="p">)</span><span class="o">-</span><span class="mi">64</span> <span class="k">for</span> <span class="n">letter</span> <span class="ow">in</span> <span class="s2">&quot;;;&gt;@BCJT^h&quot;</span><span class="p">]</span>
<span class="go">[-5, -5, -2, 0, 2, 3, 10, 20, 30, 40]</span>
</pre></div>
</div>
<p>This explains why the last few letters of this FASTQ output matched that using
the Illumina 1.3 to 1.7 format - high quality PHRED scores and Solexa scores
are approximately equal.</p>
<dl class="py function">
<dt id="Bio.SeqIO.QualityIO.solexa_quality_from_phred">
<code class="sig-prename descclassname">Bio.SeqIO.QualityIO.</code><code class="sig-name descname">solexa_quality_from_phred</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">phred_quality</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Bio.SeqIO.QualityIO.solexa_quality_from_phred" title="Permalink to this definition">¶</a></dt>
<dd><p>Covert a PHRED quality (range 0 to about 90) to a Solexa quality.</p>
<p>PHRED and Solexa quality scores are both log transformations of a
probality of error (high score = low probability of error). This function
takes a PHRED score, transforms it back to a probability of error, and
then re-expresses it as a Solexa score. This assumes the error estimates
are equivalent.</p>
<p>How does this work exactly? Well the PHRED quality is minus ten times the
base ten logarithm of the probability of error:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">phred_quality</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<p>Therefore, turning this round:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">error</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span> <span class="n">phred_quality</span> <span class="o">/</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<p>Now, Solexa qualities use a different log transformation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">solexa_quality</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">error</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">error</span><span class="p">),</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<p>After substitution and a little manipulation we get:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">solexa_quality</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">phred_quality</span><span class="o">/</span><span class="mf">10.0</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<p>However, real Solexa files use a minimum quality of -5. This does have a
good reason - a random base call would be correct 25% of the time,
and thus have a probability of error of 0.75, which gives 1.25 as the PHRED
quality, or -4.77 as the Solexa quality. Thus (after rounding), a random
nucleotide read would have a PHRED quality of 1, or a Solexa quality of -5.</p>
<p>Taken literally, this logarithic formula would map a PHRED quality of zero
to a Solexa quality of minus infinity. Of course, taken literally, a PHRED
score of zero means a probability of error of one (i.e. the base call is
definitely wrong), which is worse than random! In practice, a PHRED quality
of zero usually means a default value, or perhaps random - and therefore
mapping it to the minimum Solexa score of -5 is reasonable.</p>
<p>In conclusion, we follow EMBOSS, and take this logarithmic formula but also
apply a minimum value of -5.0 for the Solexa quality, and also map a PHRED
quality of zero to -5.0 as well.</p>
<p>Note this function will return a floating point number, it is up to you to
round this to the nearest integer if appropriate.  e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%0.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">round</span><span class="p">(</span><span class="n">solexa_quality_from_phred</span><span class="p">(</span><span class="mi">80</span><span class="p">),</span> <span class="mi">2</span><span class="p">))</span>
<span class="go">80.00</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%0.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">round</span><span class="p">(</span><span class="n">solexa_quality_from_phred</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span> <span class="mi">2</span><span class="p">))</span>
<span class="go">50.00</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%0.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">round</span><span class="p">(</span><span class="n">solexa_quality_from_phred</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span> <span class="mi">2</span><span class="p">))</span>
<span class="go">19.96</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%0.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">round</span><span class="p">(</span><span class="n">solexa_quality_from_phred</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="mi">2</span><span class="p">))</span>
<span class="go">9.54</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%0.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">round</span><span class="p">(</span><span class="n">solexa_quality_from_phred</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="mi">2</span><span class="p">))</span>
<span class="go">3.35</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%0.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">round</span><span class="p">(</span><span class="n">solexa_quality_from_phred</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="mi">2</span><span class="p">))</span>
<span class="go">1.80</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%0.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">round</span><span class="p">(</span><span class="n">solexa_quality_from_phred</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="mi">2</span><span class="p">))</span>
<span class="go">-0.02</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%0.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">round</span><span class="p">(</span><span class="n">solexa_quality_from_phred</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">2</span><span class="p">))</span>
<span class="go">-2.33</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%0.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">round</span><span class="p">(</span><span class="n">solexa_quality_from_phred</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">))</span>
<span class="go">-5.00</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%0.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">round</span><span class="p">(</span><span class="n">solexa_quality_from_phred</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="mi">2</span><span class="p">))</span>
<span class="go">-5.00</span>
</pre></div>
</div>
<p>Notice that for high quality reads PHRED and Solexa scores are numerically
equal. The differences are important for poor quality reads, where PHRED
has a minimum of zero but Solexa scores can be negative.</p>
<p>Finally, as a special case where None is used for a “missing value”, None
is returned:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">solexa_quality_from_phred</span><span class="p">(</span><span class="kc">None</span><span class="p">))</span>
<span class="go">None</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="Bio.SeqIO.QualityIO.phred_quality_from_solexa">
<code class="sig-prename descclassname">Bio.SeqIO.QualityIO.</code><code class="sig-name descname">phred_quality_from_solexa</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">solexa_quality</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Bio.SeqIO.QualityIO.phred_quality_from_solexa" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a Solexa quality (which can be negative) to a PHRED quality.</p>
<p>PHRED and Solexa quality scores are both log transformations of a
probality of error (high score = low probability of error). This function
takes a Solexa score, transforms it back to a probability of error, and
then re-expresses it as a PHRED score. This assumes the error estimates
are equivalent.</p>
<p>The underlying formulas are given in the documentation for the sister
function solexa_quality_from_phred, in this case the operation is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">phred_quality</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">solexa_quality</span><span class="o">/</span><span class="mf">10.0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<p>This will return a floating point number, it is up to you to round this to
the nearest integer if appropriate.  e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%0.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">round</span><span class="p">(</span><span class="n">phred_quality_from_solexa</span><span class="p">(</span><span class="mi">80</span><span class="p">),</span> <span class="mi">2</span><span class="p">))</span>
<span class="go">80.00</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%0.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">round</span><span class="p">(</span><span class="n">phred_quality_from_solexa</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span> <span class="mi">2</span><span class="p">))</span>
<span class="go">20.04</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%0.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">round</span><span class="p">(</span><span class="n">phred_quality_from_solexa</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="mi">2</span><span class="p">))</span>
<span class="go">10.41</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%0.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">round</span><span class="p">(</span><span class="n">phred_quality_from_solexa</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="mi">2</span><span class="p">))</span>
<span class="go">3.01</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%0.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">round</span><span class="p">(</span><span class="n">phred_quality_from_solexa</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">),</span> <span class="mi">2</span><span class="p">))</span>
<span class="go">1.19</span>
</pre></div>
</div>
<p>Note that a solexa_quality less then -5 is not expected, will trigger a
warning, but will still be converted as per the logarithmic mapping
(giving a number between 0 and 1.19 back).</p>
<p>As a special case where None is used for a “missing value”, None is
returned:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">phred_quality_from_solexa</span><span class="p">(</span><span class="kc">None</span><span class="p">))</span>
<span class="go">None</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="Bio.SeqIO.QualityIO.FastqGeneralIterator">
<code class="sig-prename descclassname">Bio.SeqIO.QualityIO.</code><code class="sig-name descname">FastqGeneralIterator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">handle</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Bio.SeqIO.QualityIO.FastqGeneralIterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate over Fastq records as string tuples (not as SeqRecord objects).</p>
<p>This code does not try to interpret the quality string numerically.  It
just returns tuples of the title, sequence and quality as strings.  For
the sequence and quality, any whitespace (such as new lines) is removed.</p>
<p>Our SeqRecord based FASTQ iterators call this function internally, and then
turn the strings into a SeqRecord objects, mapping the quality string into
a list of numerical scores.  If you want to do a custom quality mapping,
then you might consider calling this function directly.</p>
<p>For parsing FASTQ files, the title string from the “&#64;” line at the start
of each record can optionally be omitted on the “+” lines.  If it is
repeated, it must be identical.</p>
<p>The sequence string and the quality string can optionally be split over
multiple lines, although several sources discourage this.  In comparison,
for the FASTA file format line breaks between 60 and 80 characters are
the norm.</p>
<p><strong>WARNING</strong> - Because the “&#64;” character can appear in the quality string,
this can cause problems as this is also the marker for the start of
a new sequence.  In fact, the “+” sign can also appear as well.  Some
sources recommended having no line breaks in the  quality to avoid this,
but even that is not enough, consider this example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>@071113_EAS56_0053:1:1:998:236
TTTCTTGCCCCCATAGACTGAGACCTTCCCTAAATA
+071113_EAS56_0053:1:1:998:236
IIIIIIIIIIIIIIIIIIIIIIIIIIIIICII+III
@071113_EAS56_0053:1:1:182:712
ACCCAGCTAATTTTTGTATTTTTGTTAGAGACAGTG
+
@IIIIIIIIIIIIIIICDIIIII&lt;%&lt;6&amp;-*).(*%+
@071113_EAS56_0053:1:1:153:10
TGTTCTGAAGGAAGGTGTGCGTGCGTGTGTGTGTGT
+
IIIIIIIIIIIICIIGIIIII&gt;IAIIIE65I=II:6
@071113_EAS56_0053:1:3:990:501
TGGGAGGTTTTATGTGGA
AAGCAGCAATGTACAAGA
+
IIIIIII.IIIIII1@44
@-7.%&lt;&amp;+/$/%4(++(%
</pre></div>
</div>
<p>This is four PHRED encoded FASTQ entries originally from an NCBI source
(given the read length of 36, these are probably Solexa Illumina reads where
the quality has been mapped onto the PHRED values).</p>
<p>This example has been edited to illustrate some of the nasty things allowed
in the FASTQ format.  Firstly, on the “+” lines most but not all of the
(redundant) identifiers are omitted.  In real files it is likely that all or
none of these extra identifiers will be present.</p>
<p>Secondly, while the first three sequences have been shown without line
breaks, the last has been split over multiple lines.  In real files any line
breaks are likely to be consistent.</p>
<p>Thirdly, some of the quality string lines start with an “&#64;” character.  For
the second record this is unavoidable.  However for the fourth sequence this
only happens because its quality string is split over two lines.  A naive
parser could wrongly treat any line starting with an “&#64;” as the beginning of
a new sequence!  This code copes with this possible ambiguity by keeping
track of the length of the sequence which gives the expected length of the
quality string.</p>
<p>Using this tricky example file as input, this short bit of code demonstrates
what this parsing function would return:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;Quality/tricky.fastq&quot;</span><span class="p">,</span> <span class="s2">&quot;rU&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">handle</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">sequence</span><span class="p">,</span> <span class="n">quality</span><span class="p">)</span> <span class="ow">in</span> <span class="n">FastqGeneralIterator</span><span class="p">(</span><span class="n">handle</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sequence</span><span class="p">,</span> <span class="n">quality</span><span class="p">))</span>
<span class="gp">...</span>
<span class="go">071113_EAS56_0053:1:1:998:236</span>
<span class="go">TTTCTTGCCCCCATAGACTGAGACCTTCCCTAAATA IIIIIIIIIIIIIIIIIIIIIIIIIIIIICII+III</span>
<span class="go">071113_EAS56_0053:1:1:182:712</span>
<span class="go">ACCCAGCTAATTTTTGTATTTTTGTTAGAGACAGTG @IIIIIIIIIIIIIIICDIIIII&lt;%&lt;6&amp;-*).(*%+</span>
<span class="go">071113_EAS56_0053:1:1:153:10</span>
<span class="go">TGTTCTGAAGGAAGGTGTGCGTGCGTGTGTGTGTGT IIIIIIIIIIIICIIGIIIII&gt;IAIIIE65I=II:6</span>
<span class="go">071113_EAS56_0053:1:3:990:501</span>
<span class="go">TGGGAGGTTTTATGTGGAAAGCAGCAATGTACAAGA IIIIIII.IIIIII1@44@-7.%&lt;&amp;+/$/%4(++(%</span>
</pre></div>
</div>
<p>Finally we note that some sources state that the quality string should
start with “!” (which using the PHRED mapping means the first letter always
has a quality score of zero).  This rather restrictive rule is not widely
observed, so is therefore ignored here.  One plus point about this “!” rule
is that (provided there are no line breaks in the quality sequence) it
would prevent the above problem with the “&#64;” character.</p>
</dd></dl>

<dl class="py function">
<dt id="Bio.SeqIO.QualityIO.FastqPhredIterator">
<code class="sig-prename descclassname">Bio.SeqIO.QualityIO.</code><code class="sig-name descname">FastqPhredIterator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">handle</span></em>, <em class="sig-param"><span class="n">alphabet</span><span class="o">=</span><span class="default_value">SingleLetterAlphabet()</span></em>, <em class="sig-param"><span class="n">title2ids</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Bio.SeqIO.QualityIO.FastqPhredIterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate over FASTQ records as SeqRecord objects.</p>
<dl class="simple">
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>handle - input file</p></li>
<li><p>alphabet - optional alphabet</p></li>
<li><p>title2ids - A function that, when given the title line from the FASTQ
file (without the beginning &gt;), will return the id, name and
description (in that order) for the record as a tuple of strings.
If this is not given, then the entire title line will be used as
the description, and the first word as the id and name.</p></li>
</ul>
</dd>
</dl>
<p>Note that use of title2ids matches that of Bio.SeqIO.FastaIO.</p>
<p>For each sequence in a (Sanger style) FASTQ file there is a matching string
encoding the PHRED qualities (integers between 0 and about 90) using ASCII
values with an offset of 33.</p>
<p>For example, consider a file containing three short reads:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@EAS54_6_R1_2_1_413_324</span>
<span class="n">CCCTTCTTGTCTTCAGCGTTTCTCC</span>
<span class="o">+</span>
<span class="p">;;</span><span class="mi">3</span><span class="p">;;;;;;;;;;;;</span><span class="mi">7</span><span class="p">;;;;;;;</span><span class="mi">88</span>
<span class="nd">@EAS54_6_R1_2_1_540_792</span>
<span class="n">TTGGCAGGCCAAGGCCGATGGATCA</span>
<span class="o">+</span>
<span class="p">;;;;;;;;;;;</span><span class="mi">7</span><span class="p">;;;;;</span><span class="o">-</span><span class="p">;;;</span><span class="mi">3</span><span class="p">;</span><span class="mi">83</span>
<span class="nd">@EAS54_6_R1_2_1_443_348</span>
<span class="n">GTTGCTTCTGGCGTGGGTGGGGGGG</span>
<span class="o">+</span>
<span class="p">;;;;;;;;;;;</span><span class="mi">9</span><span class="p">;</span><span class="mi">7</span><span class="p">;;</span><span class="o">.</span><span class="mi">7</span><span class="p">;</span><span class="mi">393333</span>
</pre></div>
</div>
<p>For each sequence (e.g. “CCCTTCTTGTCTTCAGCGTTTCTCC”) there is a matching
string encoding the PHRED qualities using a ASCII values with an offset of
33 (e.g. “;;3;;;;;;;;;;;;7;;;;;;;88”).</p>
<p>Using this module directly you might run:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;Quality/example.fastq&quot;</span><span class="p">,</span> <span class="s2">&quot;rU&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">handle</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">FastqPhredIterator</span><span class="p">(</span><span class="n">handle</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">record</span><span class="o">.</span><span class="n">seq</span><span class="p">))</span>
<span class="go">EAS54_6_R1_2_1_413_324 CCCTTCTTGTCTTCAGCGTTTCTCC</span>
<span class="go">EAS54_6_R1_2_1_540_792 TTGGCAGGCCAAGGCCGATGGATCA</span>
<span class="go">EAS54_6_R1_2_1_443_348 GTTGCTTCTGGCGTGGGTGGGGGGG</span>
</pre></div>
</div>
<p>Typically however, you would call this via Bio.SeqIO instead with “fastq”
(or “fastq-sanger”) as the format:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Bio</span> <span class="kn">import</span> <span class="n">SeqIO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;Quality/example.fastq&quot;</span><span class="p">,</span> <span class="s2">&quot;rU&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">handle</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">SeqIO</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="s2">&quot;fastq&quot;</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">record</span><span class="o">.</span><span class="n">seq</span><span class="p">))</span>
<span class="go">EAS54_6_R1_2_1_413_324 CCCTTCTTGTCTTCAGCGTTTCTCC</span>
<span class="go">EAS54_6_R1_2_1_540_792 TTGGCAGGCCAAGGCCGATGGATCA</span>
<span class="go">EAS54_6_R1_2_1_443_348 GTTGCTTCTGGCGTGGGTGGGGGGG</span>
</pre></div>
</div>
<p>If you want to look at the qualities, they are record in each record’s
per-letter-annotation dictionary as a simple list of integers:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">letter_annotations</span><span class="p">[</span><span class="s2">&quot;phred_quality&quot;</span><span class="p">])</span>
<span class="go">[26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 24, 26, 22, 26, 26, 13, 22, 26, 18, 24, 18, 18, 18, 18]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="Bio.SeqIO.QualityIO.FastqSolexaIterator">
<code class="sig-prename descclassname">Bio.SeqIO.QualityIO.</code><code class="sig-name descname">FastqSolexaIterator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">handle</span></em>, <em class="sig-param"><span class="n">alphabet</span><span class="o">=</span><span class="default_value">SingleLetterAlphabet()</span></em>, <em class="sig-param"><span class="n">title2ids</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Bio.SeqIO.QualityIO.FastqSolexaIterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse old Solexa/Illumina FASTQ like files (which differ in the quality mapping).</p>
<p>The optional arguments are the same as those for the FastqPhredIterator.</p>
<p>For each sequence in Solexa/Illumina FASTQ files there is a matching string
encoding the Solexa integer qualities using ASCII values with an offset
of 64.  Solexa scores are scaled differently to PHRED scores, and Biopython
will NOT perform any automatic conversion when loading.</p>
<p>NOTE - This file format is used by the OLD versions of the Solexa/Illumina
pipeline. See also the FastqIlluminaIterator function for the NEW version.</p>
<p>For example, consider a file containing these five records:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@SLXA</span><span class="o">-</span><span class="n">B3_649_FC8437_R1_1_1_610_79</span>
<span class="n">GATGTGCAATACCTTTGTAGAGGAA</span>
<span class="o">+</span><span class="n">SLXA</span><span class="o">-</span><span class="n">B3_649_FC8437_R1_1_1_610_79</span>
<span class="n">YYYYYYYYYYYYYYYYYYWYWYYSU</span>
<span class="nd">@SLXA</span><span class="o">-</span><span class="n">B3_649_FC8437_R1_1_1_397_389</span>
<span class="n">GGTTTGAGAAAGAGAAATGAGATAA</span>
<span class="o">+</span><span class="n">SLXA</span><span class="o">-</span><span class="n">B3_649_FC8437_R1_1_1_397_389</span>
<span class="n">YYYYYYYYYWYYYYWWYYYWYWYWW</span>
<span class="nd">@SLXA</span><span class="o">-</span><span class="n">B3_649_FC8437_R1_1_1_850_123</span>
<span class="n">GAGGGTGTTGATCATGATGATGGCG</span>
<span class="o">+</span><span class="n">SLXA</span><span class="o">-</span><span class="n">B3_649_FC8437_R1_1_1_850_123</span>
<span class="n">YYYYYYYYYYYYYWYYWYYSYYYSY</span>
<span class="nd">@SLXA</span><span class="o">-</span><span class="n">B3_649_FC8437_R1_1_1_362_549</span>
<span class="n">GGAAACAAAGTTTTTCTCAACATAG</span>
<span class="o">+</span><span class="n">SLXA</span><span class="o">-</span><span class="n">B3_649_FC8437_R1_1_1_362_549</span>
<span class="n">YYYYYYYYYYYYYYYYYYWWWWYWY</span>
<span class="nd">@SLXA</span><span class="o">-</span><span class="n">B3_649_FC8437_R1_1_1_183_714</span>
<span class="n">GTATTATTTAATGGCATACACTCAA</span>
<span class="o">+</span><span class="n">SLXA</span><span class="o">-</span><span class="n">B3_649_FC8437_R1_1_1_183_714</span>
<span class="n">YYYYYYYYYYWYYYYWYWWUWWWQQ</span>
</pre></div>
</div>
<p>Using this module directly you might run:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;Quality/solexa_example.fastq&quot;</span><span class="p">,</span> <span class="s2">&quot;rU&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">handle</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">FastqSolexaIterator</span><span class="p">(</span><span class="n">handle</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">record</span><span class="o">.</span><span class="n">seq</span><span class="p">))</span>
<span class="go">SLXA-B3_649_FC8437_R1_1_1_610_79 GATGTGCAATACCTTTGTAGAGGAA</span>
<span class="go">SLXA-B3_649_FC8437_R1_1_1_397_389 GGTTTGAGAAAGAGAAATGAGATAA</span>
<span class="go">SLXA-B3_649_FC8437_R1_1_1_850_123 GAGGGTGTTGATCATGATGATGGCG</span>
<span class="go">SLXA-B3_649_FC8437_R1_1_1_362_549 GGAAACAAAGTTTTTCTCAACATAG</span>
<span class="go">SLXA-B3_649_FC8437_R1_1_1_183_714 GTATTATTTAATGGCATACACTCAA</span>
</pre></div>
</div>
<p>Typically however, you would call this via Bio.SeqIO instead with
“fastq-solexa” as the format:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Bio</span> <span class="kn">import</span> <span class="n">SeqIO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;Quality/solexa_example.fastq&quot;</span><span class="p">,</span> <span class="s2">&quot;rU&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">handle</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">SeqIO</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="s2">&quot;fastq-solexa&quot;</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">record</span><span class="o">.</span><span class="n">seq</span><span class="p">))</span>
<span class="go">SLXA-B3_649_FC8437_R1_1_1_610_79 GATGTGCAATACCTTTGTAGAGGAA</span>
<span class="go">SLXA-B3_649_FC8437_R1_1_1_397_389 GGTTTGAGAAAGAGAAATGAGATAA</span>
<span class="go">SLXA-B3_649_FC8437_R1_1_1_850_123 GAGGGTGTTGATCATGATGATGGCG</span>
<span class="go">SLXA-B3_649_FC8437_R1_1_1_362_549 GGAAACAAAGTTTTTCTCAACATAG</span>
<span class="go">SLXA-B3_649_FC8437_R1_1_1_183_714 GTATTATTTAATGGCATACACTCAA</span>
</pre></div>
</div>
<p>If you want to look at the qualities, they are recorded in each record’s
per-letter-annotation dictionary as a simple list of integers:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">letter_annotations</span><span class="p">[</span><span class="s2">&quot;solexa_quality&quot;</span><span class="p">])</span>
<span class="go">[25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 23, 25, 25, 25, 25, 23, 25, 23, 23, 21, 23, 23, 23, 17, 17]</span>
</pre></div>
</div>
<p>These scores aren’t very good, but they are high enough that they map
almost exactly onto PHRED scores:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%0.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">phred_quality_from_solexa</span><span class="p">(</span><span class="mi">25</span><span class="p">))</span>
<span class="go">25.01</span>
</pre></div>
</div>
<p>Let’s look at faked example read which is even worse, where there are
more noticeable differences between the Solexa and PHRED scores:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>@slxa_0001_1_0001_01
ACGTACGTACGTACGTACGTACGTACGTACGTACGTACGTNNNNNN
+slxa_0001_1_0001_01
hgfedcba`_^]\[ZYXWVUTSRQPONMLKJIHGFEDCBA@?&gt;=&lt;;
</pre></div>
</div>
<p>Again, you would typically use Bio.SeqIO to read this file in (rather than
calling the Bio.SeqIO.QualtityIO module directly).  Most FASTQ files will
contain thousands of reads, so you would normally use Bio.SeqIO.parse()
as shown above.  This example has only as one entry, so instead we can
use the Bio.SeqIO.read() function:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Bio</span> <span class="kn">import</span> <span class="n">SeqIO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;Quality/solexa_faked.fastq&quot;</span><span class="p">,</span> <span class="s2">&quot;rU&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">handle</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">record</span> <span class="o">=</span> <span class="n">SeqIO</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="s2">&quot;fastq-solexa&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">record</span><span class="o">.</span><span class="n">seq</span><span class="p">))</span>
<span class="go">slxa_0001_1_0001_01 ACGTACGTACGTACGTACGTACGTACGTACGTACGTACGTNNNNNN</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">letter_annotations</span><span class="p">[</span><span class="s2">&quot;solexa_quality&quot;</span><span class="p">])</span>
<span class="go">[40, 39, 38, 37, 36, 35, 34, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0, -1, -2, -3, -4, -5]</span>
</pre></div>
</div>
<p>These quality scores are so low that when converted from the Solexa scheme
into PHRED scores they look quite different:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%0.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">phred_quality_from_solexa</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<span class="go">2.54</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%0.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">phred_quality_from_solexa</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">))</span>
<span class="go">1.19</span>
</pre></div>
</div>
<p>Note you can use the Bio.SeqIO.write() function or the SeqRecord’s format
method to output the record(s):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;fastq-solexa&quot;</span><span class="p">))</span>
<span class="go">@slxa_0001_1_0001_01</span>
<span class="go">ACGTACGTACGTACGTACGTACGTACGTACGTACGTACGTNNNNNN</span>
<span class="go">+</span>
<span class="go">hgfedcba`_^]\[ZYXWVUTSRQPONMLKJIHGFEDCBA@?&gt;=&lt;;</span>
</pre></div>
</div>
<p>Note this output is slightly different from the input file as Biopython
has left out the optional repetition of the sequence identifier on the “+”
line.  If you want the to use PHRED scores, use “fastq” or “qual” as the
output format instead, and Biopython will do the conversion for you:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;fastq&quot;</span><span class="p">))</span>
<span class="go">@slxa_0001_1_0001_01</span>
<span class="go">ACGTACGTACGTACGTACGTACGTACGTACGTACGTACGTNNNNNN</span>
<span class="go">+</span>
<span class="go">IHGFEDCBA@?&gt;=&lt;;:9876543210/.-,++*)(&#39;&amp;&amp;%%$$##&quot;&quot;</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;qual&quot;</span><span class="p">))</span>
<span class="go">&gt;slxa_0001_1_0001_01</span>
<span class="go">40 39 38 37 36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21</span>
<span class="go">20 19 18 17 16 15 14 13 12 11 10 10 9 8 7 6 5 5 4 4 3 3 2 2</span>
<span class="go">1 1</span>
</pre></div>
</div>
<p>As shown above, the poor quality Solexa reads have been mapped to the
equivalent PHRED score (e.g. -5 to 1 as shown earlier).</p>
</dd></dl>

<dl class="py function">
<dt id="Bio.SeqIO.QualityIO.FastqIlluminaIterator">
<code class="sig-prename descclassname">Bio.SeqIO.QualityIO.</code><code class="sig-name descname">FastqIlluminaIterator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">handle</span></em>, <em class="sig-param"><span class="n">alphabet</span><span class="o">=</span><span class="default_value">SingleLetterAlphabet()</span></em>, <em class="sig-param"><span class="n">title2ids</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Bio.SeqIO.QualityIO.FastqIlluminaIterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse Illumina 1.3 to 1.7 FASTQ like files (which differ in the quality mapping).</p>
<p>The optional arguments are the same as those for the FastqPhredIterator.</p>
<p>For each sequence in Illumina 1.3+ FASTQ files there is a matching string
encoding PHRED integer qualities using ASCII values with an offset of 64.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Bio</span> <span class="kn">import</span> <span class="n">SeqIO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">record</span> <span class="o">=</span> <span class="n">SeqIO</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;Quality/illumina_faked.fastq&quot;</span><span class="p">,</span> <span class="s2">&quot;fastq-illumina&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">record</span><span class="o">.</span><span class="n">seq</span><span class="p">))</span>
<span class="go">Test ACGTACGTACGTACGTACGTACGTACGTACGTACGTACGTN</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">max</span><span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">letter_annotations</span><span class="p">[</span><span class="s2">&quot;phred_quality&quot;</span><span class="p">])</span>
<span class="go">40</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">min</span><span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">letter_annotations</span><span class="p">[</span><span class="s2">&quot;phred_quality&quot;</span><span class="p">])</span>
<span class="go">0</span>
</pre></div>
</div>
<p>NOTE - Older versions of the Solexa/Illumina pipeline encoded Solexa scores
with an ASCII offset of 64. They are approximately equal but only for high
quality reads. If you have an old Solexa/Illumina file with negative
Solexa scores, and try and read this as an Illumina 1.3+ file it will fail:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">record2</span> <span class="o">=</span> <span class="n">SeqIO</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;Quality/solexa_faked.fastq&quot;</span><span class="p">,</span> <span class="s2">&quot;fastq-illumina&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
   <span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Invalid character in quality string</span>
</pre></div>
</div>
<p>NOTE - True Sanger style FASTQ files use PHRED scores with an offset of 33.</p>
</dd></dl>

<dl class="py function">
<dt id="Bio.SeqIO.QualityIO.QualPhredIterator">
<code class="sig-prename descclassname">Bio.SeqIO.QualityIO.</code><code class="sig-name descname">QualPhredIterator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">handle</span></em>, <em class="sig-param"><span class="n">alphabet</span><span class="o">=</span><span class="default_value">SingleLetterAlphabet()</span></em>, <em class="sig-param"><span class="n">title2ids</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Bio.SeqIO.QualityIO.QualPhredIterator" title="Permalink to this definition">¶</a></dt>
<dd><p>For QUAL files which include PHRED quality scores, but no sequence.</p>
<p>For example, consider this short QUAL file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span><span class="n">EAS54_6_R1_2_1_413_324</span>
<span class="mi">26</span> <span class="mi">26</span> <span class="mi">18</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">22</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span>
<span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">23</span> <span class="mi">23</span>
<span class="o">&gt;</span><span class="n">EAS54_6_R1_2_1_540_792</span>
<span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">22</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">12</span> <span class="mi">26</span> <span class="mi">26</span>
<span class="mi">26</span> <span class="mi">18</span> <span class="mi">26</span> <span class="mi">23</span> <span class="mi">18</span>
<span class="o">&gt;</span><span class="n">EAS54_6_R1_2_1_443_348</span>
<span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">24</span> <span class="mi">26</span> <span class="mi">22</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">13</span> <span class="mi">22</span> <span class="mi">26</span> <span class="mi">18</span>
<span class="mi">24</span> <span class="mi">18</span> <span class="mi">18</span> <span class="mi">18</span> <span class="mi">18</span>
</pre></div>
</div>
<p>Using this module directly you might run:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;Quality/example.qual&quot;</span><span class="p">,</span> <span class="s2">&quot;rU&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">handle</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">QualPhredIterator</span><span class="p">(</span><span class="n">handle</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">record</span><span class="o">.</span><span class="n">seq</span><span class="p">))</span>
<span class="go">EAS54_6_R1_2_1_413_324 ?????????????????????????</span>
<span class="go">EAS54_6_R1_2_1_540_792 ?????????????????????????</span>
<span class="go">EAS54_6_R1_2_1_443_348 ?????????????????????????</span>
</pre></div>
</div>
<p>Typically however, you would call this via Bio.SeqIO instead with “qual”
as the format:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Bio</span> <span class="kn">import</span> <span class="n">SeqIO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;Quality/example.qual&quot;</span><span class="p">,</span> <span class="s2">&quot;rU&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">handle</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">SeqIO</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="s2">&quot;qual&quot;</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">record</span><span class="o">.</span><span class="n">seq</span><span class="p">))</span>
<span class="go">EAS54_6_R1_2_1_413_324 ?????????????????????????</span>
<span class="go">EAS54_6_R1_2_1_540_792 ?????????????????????????</span>
<span class="go">EAS54_6_R1_2_1_443_348 ?????????????????????????</span>
</pre></div>
</div>
<p>Becase QUAL files don’t contain the sequence string itself, the seq
property is set to an UnknownSeq object.  As no alphabet was given, this
has defaulted to a generic single letter alphabet and the character “?”
used.</p>
<p>By specifying a nucleotide alphabet, “N” is used instead:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Bio</span> <span class="kn">import</span> <span class="n">SeqIO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Bio.Alphabet</span> <span class="kn">import</span> <span class="n">generic_dna</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;Quality/example.qual&quot;</span><span class="p">,</span> <span class="s2">&quot;rU&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">handle</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">SeqIO</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="s2">&quot;qual&quot;</span><span class="p">,</span> <span class="n">alphabet</span><span class="o">=</span><span class="n">generic_dna</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">record</span><span class="o">.</span><span class="n">seq</span><span class="p">))</span>
<span class="go">EAS54_6_R1_2_1_413_324 NNNNNNNNNNNNNNNNNNNNNNNNN</span>
<span class="go">EAS54_6_R1_2_1_540_792 NNNNNNNNNNNNNNNNNNNNNNNNN</span>
<span class="go">EAS54_6_R1_2_1_443_348 NNNNNNNNNNNNNNNNNNNNNNNNN</span>
</pre></div>
</div>
<p>However, the quality scores themselves are available as a list of integers
in each record’s per-letter-annotation:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">letter_annotations</span><span class="p">[</span><span class="s2">&quot;phred_quality&quot;</span><span class="p">])</span>
<span class="go">[26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 24, 26, 22, 26, 26, 13, 22, 26, 18, 24, 18, 18, 18, 18]</span>
</pre></div>
</div>
<p>You can still slice one of these SeqRecord objects with an UnknownSeq:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sub_record</span> <span class="o">=</span> <span class="n">record</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sub_record</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">sub_record</span><span class="o">.</span><span class="n">letter_annotations</span><span class="p">[</span><span class="s2">&quot;phred_quality&quot;</span><span class="p">]))</span>
<span class="go">EAS54_6_R1_2_1_443_348 [26, 26, 26, 26, 26]</span>
</pre></div>
</div>
<p>As of Biopython 1.59, this parser will accept files with negatives quality
scores but will replace them with the lowest possible PHRED score of zero.
This will trigger a warning, previously it raised a ValueError exception.</p>
</dd></dl>

<dl class="py class">
<dt id="Bio.SeqIO.QualityIO.FastqPhredWriter">
<em class="property">class </em><code class="sig-prename descclassname">Bio.SeqIO.QualityIO.</code><code class="sig-name descname">FastqPhredWriter</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">handle</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Bio.SeqIO.QualityIO.FastqPhredWriter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="Bio.SeqIO.Interfaces.html#Bio.SeqIO.Interfaces.SequentialSequenceWriter" title="Bio.SeqIO.Interfaces.SequentialSequenceWriter"><code class="xref py py-class docutils literal notranslate"><span class="pre">Bio.SeqIO.Interfaces.SequentialSequenceWriter</span></code></a></p>
<p>Class to write standard FASTQ format files (using PHRED quality scores) (OBSOLETE).</p>
<p>Although you can use this class directly, you are strongly encouraged
to use the <code class="docutils literal notranslate"><span class="pre">as_fastq</span></code> function, or top level <code class="docutils literal notranslate"><span class="pre">Bio.SeqIO.write()</span></code>
function instead via the format name “fastq” or the alias “fastq-sanger”.</p>
<p>For example, this code reads in a standard Sanger style FASTQ file
(using PHRED scores) and re-saves it as another Sanger style FASTQ file:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Bio</span> <span class="kn">import</span> <span class="n">SeqIO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">record_iterator</span> <span class="o">=</span> <span class="n">SeqIO</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s2">&quot;Quality/example.fastq&quot;</span><span class="p">,</span> <span class="s2">&quot;fastq&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;Quality/temp.fastq&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">out_handle</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">SeqIO</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">record_iterator</span><span class="p">,</span> <span class="n">out_handle</span><span class="p">,</span> <span class="s2">&quot;fastq&quot;</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
<p>You might want to do this if the original file included extra line breaks,
which while valid may not be supported by all tools.  The output file from
Biopython will have each sequence on a single line, and each quality
string on a single line (which is considered desirable for maximum
compatibility).</p>
<p>In this next example, an old style Solexa/Illumina FASTQ file (using Solexa
quality scores) is converted into a standard Sanger style FASTQ file using
PHRED qualities:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Bio</span> <span class="kn">import</span> <span class="n">SeqIO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">record_iterator</span> <span class="o">=</span> <span class="n">SeqIO</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s2">&quot;Quality/solexa_example.fastq&quot;</span><span class="p">,</span> <span class="s2">&quot;fastq-solexa&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;Quality/temp.fastq&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">out_handle</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">SeqIO</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">record_iterator</span><span class="p">,</span> <span class="n">out_handle</span><span class="p">,</span> <span class="s2">&quot;fastq&quot;</span><span class="p">)</span>
<span class="go">5</span>
</pre></div>
</div>
<p>This code is also called if you use the .format(“fastq”) method of a
SeqRecord, or .format(“fastq-sanger”) if you prefer that alias.</p>
<p>Note that Sanger FASTQ files have an upper limit of PHRED quality 93, which is
encoded as ASCII 126, the tilde. If your quality scores are truncated to fit, a
warning is issued.</p>
<p>P.S. To avoid cluttering up your working directory, you can delete this
temporary file now:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s2">&quot;Quality/temp.fastq&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt id="Bio.SeqIO.QualityIO.FastqPhredWriter.write_record">
<code class="sig-name descname">write_record</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em>, <em class="sig-param"><span class="n">record</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Bio.SeqIO.QualityIO.FastqPhredWriter.write_record" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a single FASTQ record to the file.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="Bio.SeqIO.QualityIO.as_fastq">
<code class="sig-prename descclassname">Bio.SeqIO.QualityIO.</code><code class="sig-name descname">as_fastq</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">record</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Bio.SeqIO.QualityIO.as_fastq" title="Permalink to this definition">¶</a></dt>
<dd><p>Turn a SeqRecord into a Sanger FASTQ formated string.</p>
<p>This is used internally by the SeqRecord’s .format(“fastq”)
method and by the SeqIO.write(…, …, “fastq”) function,
and under the format alias “fastq-sanger” as well.</p>
</dd></dl>

<dl class="py class">
<dt id="Bio.SeqIO.QualityIO.QualPhredWriter">
<em class="property">class </em><code class="sig-prename descclassname">Bio.SeqIO.QualityIO.</code><code class="sig-name descname">QualPhredWriter</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">handle</span></em>, <em class="sig-param"><span class="n">wrap</span><span class="o">=</span><span class="default_value">60</span></em>, <em class="sig-param"><span class="n">record2title</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Bio.SeqIO.QualityIO.QualPhredWriter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="Bio.SeqIO.Interfaces.html#Bio.SeqIO.Interfaces.SequentialSequenceWriter" title="Bio.SeqIO.Interfaces.SequentialSequenceWriter"><code class="xref py py-class docutils literal notranslate"><span class="pre">Bio.SeqIO.Interfaces.SequentialSequenceWriter</span></code></a></p>
<p>Class to write QUAL format files (using PHRED quality scores) (OBSOLETE).</p>
<p>Although you can use this class directly, you are strongly encouraged
to use the <code class="docutils literal notranslate"><span class="pre">as_qual</span></code> function, or top level <code class="docutils literal notranslate"><span class="pre">Bio.SeqIO.write()</span></code>
function instead.</p>
<p>For example, this code reads in a FASTQ file and saves the quality scores
into a QUAL file:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Bio</span> <span class="kn">import</span> <span class="n">SeqIO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">record_iterator</span> <span class="o">=</span> <span class="n">SeqIO</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s2">&quot;Quality/example.fastq&quot;</span><span class="p">,</span> <span class="s2">&quot;fastq&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;Quality/temp.qual&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">out_handle</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">SeqIO</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">record_iterator</span><span class="p">,</span> <span class="n">out_handle</span><span class="p">,</span> <span class="s2">&quot;qual&quot;</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
<p>This code is also called if you use the .format(“qual”) method of a
SeqRecord.</p>
<p>P.S. Don’t forget to clean up the temp file if you don’t need it anymore:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s2">&quot;Quality/temp.qual&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt id="Bio.SeqIO.QualityIO.QualPhredWriter.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em>, <em class="sig-param"><span class="n">handle</span></em>, <em class="sig-param"><span class="n">wrap</span><span class="o">=</span><span class="default_value">60</span></em>, <em class="sig-param"><span class="n">record2title</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Bio.SeqIO.QualityIO.QualPhredWriter.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a QUAL writer.</p>
<dl class="simple">
<dt>Arguments:</dt><dd><ul class="simple">
<li><p>handle - Handle to an output file, e.g. as returned
by open(filename, “w”)</p></li>
<li><p>wrap   - Optional line length used to wrap sequence lines.
Defaults to wrapping the sequence at 60 characters. Use
zero (or None) for no wrapping, giving a single long line
for the sequence.</p></li>
<li><p>record2title - Optional function to return the text to be
used for the title line of each record.  By default a
combination of the record.id and record.description is
used.  If the record.description starts with the record.id,
then just the record.description is used.</p></li>
</ul>
</dd>
</dl>
<p>The record2title argument is present for consistency with the
Bio.SeqIO.FastaIO writer class.</p>
</dd></dl>

<dl class="py method">
<dt id="Bio.SeqIO.QualityIO.QualPhredWriter.write_record">
<code class="sig-name descname">write_record</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em>, <em class="sig-param"><span class="n">record</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Bio.SeqIO.QualityIO.QualPhredWriter.write_record" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a single QUAL record to the file.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="Bio.SeqIO.QualityIO.as_qual">
<code class="sig-prename descclassname">Bio.SeqIO.QualityIO.</code><code class="sig-name descname">as_qual</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">record</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Bio.SeqIO.QualityIO.as_qual" title="Permalink to this definition">¶</a></dt>
<dd><p>Turn a SeqRecord into a QUAL formated string.</p>
<p>This is used internally by the SeqRecord’s .format(“qual”)
method and by the SeqIO.write(…, …, “qual”) function.</p>
</dd></dl>

<dl class="py class">
<dt id="Bio.SeqIO.QualityIO.FastqSolexaWriter">
<em class="property">class </em><code class="sig-prename descclassname">Bio.SeqIO.QualityIO.</code><code class="sig-name descname">FastqSolexaWriter</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">handle</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Bio.SeqIO.QualityIO.FastqSolexaWriter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="Bio.SeqIO.Interfaces.html#Bio.SeqIO.Interfaces.SequentialSequenceWriter" title="Bio.SeqIO.Interfaces.SequentialSequenceWriter"><code class="xref py py-class docutils literal notranslate"><span class="pre">Bio.SeqIO.Interfaces.SequentialSequenceWriter</span></code></a></p>
<p>Write old style Solexa/Illumina FASTQ format files (with Solexa qualities) (OBSOLETE).</p>
<p>This outputs FASTQ files like those from the early Solexa/Illumina
pipeline, using Solexa scores and an ASCII offset of 64. These are
NOT compatible with the standard Sanger style PHRED FASTQ files.</p>
<p>If your records contain a “solexa_quality” entry under letter_annotations,
this is used, otherwise any “phred_quality” entry will be used after
conversion using the solexa_quality_from_phred function. If neither style
of quality scores are present, an exception is raised.</p>
<p>Although you can use this class directly, you are strongly encouraged
to use the <code class="docutils literal notranslate"><span class="pre">as_fastq_solexa</span></code> function, or top-level <code class="docutils literal notranslate"><span class="pre">Bio.SeqIO.write()</span></code>
function instead.  For example, this code reads in a FASTQ file and re-saves
it as another FASTQ file:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Bio</span> <span class="kn">import</span> <span class="n">SeqIO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">record_iterator</span> <span class="o">=</span> <span class="n">SeqIO</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s2">&quot;Quality/solexa_example.fastq&quot;</span><span class="p">,</span> <span class="s2">&quot;fastq-solexa&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;Quality/temp.fastq&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">out_handle</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">SeqIO</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">record_iterator</span><span class="p">,</span> <span class="n">out_handle</span><span class="p">,</span> <span class="s2">&quot;fastq-solexa&quot;</span><span class="p">)</span>
<span class="go">5</span>
</pre></div>
</div>
<p>You might want to do this if the original file included extra line breaks,
which (while valid) may not be supported by all tools.  The output file
from Biopython will have each sequence on a single line, and each quality
string on a single line (which is considered desirable for maximum
compatibility).</p>
<p>This code is also called if you use the .format(“fastq-solexa”) method of
a SeqRecord. For example,</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">record</span> <span class="o">=</span> <span class="n">SeqIO</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;Quality/sanger_faked.fastq&quot;</span><span class="p">,</span> <span class="s2">&quot;fastq-sanger&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;fastq-solexa&quot;</span><span class="p">))</span>
<span class="go">@Test PHRED qualities from 40 to 0 inclusive</span>
<span class="go">ACGTACGTACGTACGTACGTACGTACGTACGTACGTACGTN</span>
<span class="go">+</span>
<span class="go">hgfedcba`_^]\[ZYXWVUTSRQPONMLKJHGFECB@&gt;;;</span>
</pre></div>
</div>
<p>Note that Solexa FASTQ files have an upper limit of Solexa quality 62, which is
encoded as ASCII 126, the tilde.  If your quality scores must be truncated to fit,
a warning is issued.</p>
<p>P.S. Don’t forget to delete the temp file if you don’t need it anymore:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s2">&quot;Quality/temp.fastq&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt id="Bio.SeqIO.QualityIO.FastqSolexaWriter.write_record">
<code class="sig-name descname">write_record</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em>, <em class="sig-param"><span class="n">record</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Bio.SeqIO.QualityIO.FastqSolexaWriter.write_record" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a single FASTQ record to the file.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="Bio.SeqIO.QualityIO.as_fastq_solexa">
<code class="sig-prename descclassname">Bio.SeqIO.QualityIO.</code><code class="sig-name descname">as_fastq_solexa</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">record</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Bio.SeqIO.QualityIO.as_fastq_solexa" title="Permalink to this definition">¶</a></dt>
<dd><p>Turn a SeqRecord into a Solexa FASTQ formated string.</p>
<p>This is used internally by the SeqRecord’s .format(“fastq-solexa”)
method and by the SeqIO.write(…, …, “fastq-solexa”) function.</p>
</dd></dl>

<dl class="py class">
<dt id="Bio.SeqIO.QualityIO.FastqIlluminaWriter">
<em class="property">class </em><code class="sig-prename descclassname">Bio.SeqIO.QualityIO.</code><code class="sig-name descname">FastqIlluminaWriter</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">handle</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Bio.SeqIO.QualityIO.FastqIlluminaWriter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="Bio.SeqIO.Interfaces.html#Bio.SeqIO.Interfaces.SequentialSequenceWriter" title="Bio.SeqIO.Interfaces.SequentialSequenceWriter"><code class="xref py py-class docutils literal notranslate"><span class="pre">Bio.SeqIO.Interfaces.SequentialSequenceWriter</span></code></a></p>
<p>Write Illumina 1.3+ FASTQ format files (with PHRED quality scores) (OBSOLETE).</p>
<p>This outputs FASTQ files like those from the Solexa/Illumina 1.3+ pipeline,
using PHRED scores and an ASCII offset of 64. Note these files are NOT
compatible with the standard Sanger style PHRED FASTQ files which use an
ASCII offset of 32.</p>
<p>Although you can use this class directly, you are strongly encouraged to
use the <code class="docutils literal notranslate"><span class="pre">as_fastq_illumina</span></code> or top-level <code class="docutils literal notranslate"><span class="pre">Bio.SeqIO.write()</span></code> function
with format name “fastq-illumina” instead. This code is also called if you
use the .format(“fastq-illumina”) method of a SeqRecord. For example,</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Bio</span> <span class="kn">import</span> <span class="n">SeqIO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">record</span> <span class="o">=</span> <span class="n">SeqIO</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;Quality/sanger_faked.fastq&quot;</span><span class="p">,</span> <span class="s2">&quot;fastq-sanger&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;fastq-illumina&quot;</span><span class="p">))</span>
<span class="go">@Test PHRED qualities from 40 to 0 inclusive</span>
<span class="go">ACGTACGTACGTACGTACGTACGTACGTACGTACGTACGTN</span>
<span class="go">+</span>
<span class="go">hgfedcba`_^]\[ZYXWVUTSRQPONMLKJIHGFEDCBA@</span>
</pre></div>
</div>
<p>Note that Illumina FASTQ files have an upper limit of PHRED quality 62, which is
encoded as ASCII 126, the tilde. If your quality scores are truncated to fit, a
warning is issued.</p>
<dl class="py method">
<dt id="Bio.SeqIO.QualityIO.FastqIlluminaWriter.write_record">
<code class="sig-name descname">write_record</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em>, <em class="sig-param"><span class="n">record</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Bio.SeqIO.QualityIO.FastqIlluminaWriter.write_record" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a single FASTQ record to the file.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="Bio.SeqIO.QualityIO.as_fastq_illumina">
<code class="sig-prename descclassname">Bio.SeqIO.QualityIO.</code><code class="sig-name descname">as_fastq_illumina</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">record</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Bio.SeqIO.QualityIO.as_fastq_illumina" title="Permalink to this definition">¶</a></dt>
<dd><p>Turn a SeqRecord into an Illumina FASTQ formated string.</p>
<p>This is used internally by the SeqRecord’s .format(“fastq-illumina”)
method and by the SeqIO.write(…, …, “fastq-illumina”) function.</p>
</dd></dl>

<dl class="py function">
<dt id="Bio.SeqIO.QualityIO.PairedFastaQualIterator">
<code class="sig-prename descclassname">Bio.SeqIO.QualityIO.</code><code class="sig-name descname">PairedFastaQualIterator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fasta_handle</span></em>, <em class="sig-param"><span class="n">qual_handle</span></em>, <em class="sig-param"><span class="n">alphabet</span><span class="o">=</span><span class="default_value">SingleLetterAlphabet()</span></em>, <em class="sig-param"><span class="n">title2ids</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Bio.SeqIO.QualityIO.PairedFastaQualIterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate over matched FASTA and QUAL files as SeqRecord objects.</p>
<p>For example, consider this short QUAL file with PHRED quality scores:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span><span class="n">EAS54_6_R1_2_1_413_324</span>
<span class="mi">26</span> <span class="mi">26</span> <span class="mi">18</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">22</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span>
<span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">23</span> <span class="mi">23</span>
<span class="o">&gt;</span><span class="n">EAS54_6_R1_2_1_540_792</span>
<span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">22</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">12</span> <span class="mi">26</span> <span class="mi">26</span>
<span class="mi">26</span> <span class="mi">18</span> <span class="mi">26</span> <span class="mi">23</span> <span class="mi">18</span>
<span class="o">&gt;</span><span class="n">EAS54_6_R1_2_1_443_348</span>
<span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">24</span> <span class="mi">26</span> <span class="mi">22</span> <span class="mi">26</span> <span class="mi">26</span> <span class="mi">13</span> <span class="mi">22</span> <span class="mi">26</span> <span class="mi">18</span>
<span class="mi">24</span> <span class="mi">18</span> <span class="mi">18</span> <span class="mi">18</span> <span class="mi">18</span>
</pre></div>
</div>
<p>And a matching FASTA file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span><span class="n">EAS54_6_R1_2_1_413_324</span>
<span class="n">CCCTTCTTGTCTTCAGCGTTTCTCC</span>
<span class="o">&gt;</span><span class="n">EAS54_6_R1_2_1_540_792</span>
<span class="n">TTGGCAGGCCAAGGCCGATGGATCA</span>
<span class="o">&gt;</span><span class="n">EAS54_6_R1_2_1_443_348</span>
<span class="n">GTTGCTTCTGGCGTGGGTGGGGGGG</span>
</pre></div>
</div>
<p>You can parse these separately using Bio.SeqIO with the “qual” and
“fasta” formats, but then you’ll get a group of SeqRecord objects with
no sequence, and a matching group with the sequence but not the
qualities.  Because it only deals with one input file handle, Bio.SeqIO
can’t be used to read the two files together - but this function can!
For example,</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;Quality/example.fasta&quot;</span><span class="p">,</span> <span class="s2">&quot;rU&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;Quality/example.qual&quot;</span><span class="p">,</span> <span class="s2">&quot;rU&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">q</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">PairedFastaQualIterator</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">q</span><span class="p">):</span>
<span class="gp">... </span>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">record</span><span class="o">.</span><span class="n">seq</span><span class="p">))</span>
<span class="gp">...</span>
<span class="go">EAS54_6_R1_2_1_413_324 CCCTTCTTGTCTTCAGCGTTTCTCC</span>
<span class="go">EAS54_6_R1_2_1_540_792 TTGGCAGGCCAAGGCCGATGGATCA</span>
<span class="go">EAS54_6_R1_2_1_443_348 GTTGCTTCTGGCGTGGGTGGGGGGG</span>
</pre></div>
</div>
<p>As with the FASTQ or QUAL parsers, if you want to look at the qualities,
they are in each record’s per-letter-annotation dictionary as a simple
list of integers:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">letter_annotations</span><span class="p">[</span><span class="s2">&quot;phred_quality&quot;</span><span class="p">])</span>
<span class="go">[26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 24, 26, 22, 26, 26, 13, 22, 26, 18, 24, 18, 18, 18, 18]</span>
</pre></div>
</div>
<p>If you have access to data as a FASTQ format file, using that directly
would be simpler and more straight forward.  Note that you can easily use
this function to convert paired FASTA and QUAL files into FASTQ files:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">Bio</span> <span class="kn">import</span> <span class="n">SeqIO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;Quality/example.fasta&quot;</span><span class="p">,</span> <span class="s2">&quot;rU&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;Quality/example.qual&quot;</span><span class="p">,</span> <span class="s2">&quot;rU&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">q</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">SeqIO</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">PairedFastaQualIterator</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">q</span><span class="p">),</span> <span class="s2">&quot;Quality/temp.fastq&quot;</span><span class="p">,</span> <span class="s2">&quot;fastq&quot;</span><span class="p">)</span>
<span class="gp">...</span>
<span class="go">3</span>
</pre></div>
</div>
<p>And don’t forget to clean up the temp file if you don’t need it anymore:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s2">&quot;Quality/temp.fastq&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Bio.SeqIO.SeqXmlIO.html" class="btn btn-neutral float-right" title="Bio.SeqIO.SeqXmlIO module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Bio.SeqIO.PirIO.html" class="btn btn-neutral float-left" title="Bio.SeqIO.PirIO module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 1999-2020, The Biopython Contributors

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      Biopython v: 1.76
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      <dl>
        <dt>Versions</dt>
        
          <dd><a href="../../1.75/api/">Previous</a></dd>
        
          <dd><a href="../../latest/api/">Latest</a></dd>
        
          <dd><a href="../../dev/api/">Develop</a></dd>
        
      </dl>

      <dl>

        <dt>Biopython Project</dt>
          <dd>
            <a href="https://biopython.org" class="icon icon-home">  Homepage</a>
          </dd>
          <dd>
            <a href="https://github.com/biopython/biopython" class="fa fa-github">  On GitHub</a>
          </dd>
      </dl>
    </div>
  </div>


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>